---
title: 03 - Add MCP tools to your agent
description: Learn how to add MCP (Model Context Protocol) tools to Azure Logic Apps agents across three connector types - BYO/Native MCP connectors (external MCP servers), Managed MCP connectors (Azure-hosted MCP servers exposed like managed APIs), and Custom MCP connectors (user-created MCP connectors scoped to a subscription), including authentication patterns (app-only vs on-behalf-of) and monitoring.
ms.service: azure-logic-apps
ms.topic: tutorial
ms.date: 11/11/2025
author: absaafan
ms.author: absaafan
---

In this module, you learn how Azure Logic Apps agents integrate with the **Model Context Protocol (MCP)** using three connector models:

- **BYO/Native MCP connector**: You supply the MCP server URL and auth details; Logic Apps consumes the external MCP tool catalog directly.
- **Managed MCP connector**: Azure-hosted MCP servers surfaced through the standard managed connector experience; you select the MCP server similar to choosing any managed API action and reuse existing connections.
- **Custom MCP connector**: A user-built connector (OpenAPI/definition) that implements MCP endpoints; available only within your subscription/tenant for controlled distribution.

You map these into agent tools with different authentication patterns (application and on-behalf-of / user context) and observe tool calls in run history.

When you finish this module, you'll achieve the goals and complete the tasks in the following list:

- Understand MCP concepts as used by Logic Apps (tool listing at session start, structured tool calls, result streaming & monitoring).
- Use a Managed MCP connector tool inside a conversational agent workflow.
- Configure a BYO/Native MCP connector and observe its published tools.
- Surface managed connector actions via Managed MCP connector with optional on-behalf-of (OBO) authorization.
- Add and use a Custom MCP connector for private MCP server functionality.
- Monitor and compare MCP tool calls across connector types.

> :::note
> This module focuses on surfacing tools to agents via MCP. For adding dynamic inputs, see [Add parameters to your tools](./01-add-parameters-to-tools.md). For extending tool behavior, see [Extend your tool functionality with patterns](./02-extend-tools-with-patterns.md). For user-delegated (OBO) authorization concepts, see [Add user context to tools](../02_build_conversational_agents/04-add-user-context-to-tools.md).

## Overview: MCP in Logic Apps

| Concept | Logic Apps Implementation |
|---------|---------------------------|
| MCP protocol | Open source standard for tool discovery (listing) and invocation that Logic Apps agents adopt internally. Learn more about the standard [here](https://modelcontextprotocol.io/docs/getting-started/intro). |
| Tool listing | At conversation or agent loop start, Logic Apps enumerates configured tools including listing MCP server tools for those servers configured on the agent. |
| Allowed tools | An “Allowed tools” configuration constrains the subset of tools surfaced to the model for a given session, improving safety & determinism. |
| Monitoring | Run history shows each MCP tool call similarly to how other tool executions are shown. |

### Lifecycle
1. Session starts (chat or autonomous loop trigger).
2. Logic Apps builds tool catalog (respecting “Allowed tools” if configured).
3. Model receives system instructions + tool metadata.
4. Model returns either a user-facing message or an MCP tool call.
5. Logic Apps executes mapped action(s).
6. Tool result returned to model; reasoning continues until completion criteria met.
7. Run history captures full chain (prompt, tool call directive, action outputs, transformed result).

## MCP Connector Types

| Connector Type | When to use | Characteristics | Auth Options |
|----------|------------|-----------------|--------------|
| BYO/Native MCP connector (external MCP server) | You already operate or consume an external MCP server and want direct catalog ingestion. | User supplies base MCP URL + credentials; dynamic tool listing fetched from external host; minimal Azure abstraction. | None, Basic, Client certificate, Active Directory OAuth, Raw, Key, Managed identity. |
| Managed MCP connector (Azure-hosted) | Fastest path to MCP tools backed by Azure-managed infrastructure and existing managed connectors. | Selection UX mirrors managed API operations; shared connection model; automatic catalog & schema maintenance. | App-only (managed identity), per-user (OBO), API key (where supported). |
| Custom MCP connector (user-created) | Need private/tenant-scoped MCP server with custom schema/policies not globally available. | OpenAPI/definition you author; only accessible in your subscription; full control over versioning & throttling. | OAuth 2.0 (scoped), API key, Basic, managed identity (internal). |

## Part 1 - Use a Managed MCP Connector Tool in a Conversational Agent

### Step 1 - Open existing conversational agent workflow

### Step 2 - Add managed MCP connector tool

### Step 3 - OBO Auth

### Step 4 - Test & Monitor

## Part 2 - Configure a BYO/Native MCP Connector (External MCP Server)

### Step 1 - Use a Logic Apps MCP server (Link to other lab)

### Step 2 - Use MCP server in agent

### Step 3 - Monitor & Debug

## Part 3 - Use a Custom MCP Connector (OAuth / Advanced)

### Step 1 - Design connector schema

### Step 2 - Build connector (high-level)

### Step 3 - Use connector in agent

### Step 4 - Manage OAuth for BYO MCP

### Step 5 - Test & Monitor


## Run History & Monitoring for MCP Tools

| Pane Element | Description |
|--------------|-------------|
| Chat transcript | Shows assistant messages and tool call directives (functionName + arguments). |
| Tool call detail | Contains raw LLM completion that requested the MCP tool; review for argument fidelity. |
| Action result | Underlying connector/custom action output; expand only necessary fields. |
| Error propagation | Non-2xx responses surfaced; model can self-correct if prompted (“If tool fails, summarize error and ask clarifying question”). |

### Common Troubleshooting
| Issue | Resolution |
|-------|------------|
| Tool not invoked | Refine description; ensure no overlapping semantics with other tools; check Allowed tools filter. |
| Wrong parameters | Add agent parameters with clearer names & descriptions; show expected examples in system instructions. |
| Auth failure (401/403) | Recreate per-user connection; verify scopes; confirm Easy Auth or developer key for chat client. |
| Throttling (429) | Add retry (built-in), instruct model to narrow request, or consolidate batch operations. |

## Best Practices Recap
- Keep tool descriptions unique; avoid overlapping verbs (“Get” for multiple similar sources).
- Use Allowed tools for sensitive sessions or evaluation.
- Monitor early runs to refine parameter names (clarity directly influences argument extraction quality).

## Clean Up Resources
- Remove unused per-user connections; rotate app secrets (custom connector) per policy.
- Decommission experimental BYO MCP endpoints if no longer required.
- Archive run history exports if used for prompt tuning and then purge per retention standards.

## Related content
- [Connect tools to external services (conversational)](../02_build_conversational_agents/03-connect-tools-external-services.md)
- [Connect tools to external services (autonomous)](../03_build_autonomous_agents/03-connect-tools-external-services.md)
- [Add parameters to your tools](./01-add-parameters-to-tools.md)
- [Extend your tool functionality with patterns](./02-extend-tools-with-patterns.md)
- [Add user context to tools](../02_build_conversational_agents/04-add-user-context-to-tools.md)
- [Connect your agents using A2A protocol](../02_build_conversational_agents/05-connect-agents-a2a-protocol.md)

## Next steps
Proceed to the next module to integrate agent-to-agent protocol scenarios or revisit earlier modules to parameterize newly added MCP tools for dynamic argument generation.

